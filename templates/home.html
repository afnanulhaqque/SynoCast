{% extends "base.html" %}
{% from "macros.html" import news_card, weather_news_card %}

{% block title %} Home {% endblock title %}

{% block body %}

<div class="position-relative w-100 home-banner-container" style="height: 50vh;">
  <img src="/assets/images/banner-home.png" class="w-100 h-100 position-absolute top-0 start-0" alt="Banner"
    style="z-index: -1; object-fit: cover; object-position: center;" fetchpriority="high">
  <div class="position-absolute top-0 start-0 w-100 h-100 bg-dark" style="z-index: -1; opacity: 0.2;"></div>

  <div class="container h-100">
    <div class="row h-100 align-items-center">
      <div class="col-lg-6 text-white pb-5">
        <h1 class="fw-bold display-3 mb-3" style="text-shadow: 0 2px-10px rgba(0,0,0,0.3);">SynoCast</h1>
        <p class="fs-4 fw-light lh-sm">
          Your Weather, Your Journey: Always a Step Ahead with Our
          <span class="fw-bold">Weather Forecasting App!</span>
        </p>
      </div>
    </div>
  </div>
</div>

<div class="container position-relative" style="margin-top: -250px; z-index: 10;">
  <div class="row">
    <div class="col-lg-6" style="padding-top: 280px;">
      <div style="max-width: 450px;">
        <h2 class="h3 mb-4 lh-base">Stay prepared for upcoming weather with <span class="fw-bold">daily weather
            news.</span></h2>
        <a href="/news" class="btn btn_explore rounded-pill border-2 fw-semibold text-decoration-none">Explore</a>
        <div class="mt-5 position-relative">
          <img src="/assets/images/weatherTrip-banner_1.svg" class="img-fluid" alt="Weather App User">
        </div>
      </div>
    </div>

    <div class="col-lg-6 d-flex flex-column align-items-center align-items-lg-end">
      <div class="bg-white rounded-4 shadow-lg p-0 mb-5 overflow-hidden" style="width: 350px;">
        {% include 'sub_banner_card.html' %}
      </div>

      <!-- AI Recommendations Widget -->
      <div id="ai-recs-widget" class="card border-0 rounded-4 shadow-lg p-4 mb-5 d-none"
        style="width: 350px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
        <div class="d-flex align-items-center mb-3">
          <i class="fas fa-robot me-2"></i>
          <h5 class="fw-bold mb-0">AI Insights</h5>
        </div>
        <div id="ai-recs-content" class="small fw-light">
          Analyzing current weather to give you personalized tips...
        </div>
      </div>

      <div class="text-center text-lg-end mt-4" style="max-width: 400px;">
        <h2 class="h3 fw-bold mb-3">Don't guess the weather.</h2>
        <p class="text-muted mb-4">Real-time forecasts and AI insights for your location and across the world.</p>
        <a href="/weather" class="btn btn_get_started rounded-pill fw-semibold text-decoration-none">Get started</a>
      </div>
    </div>
  </div>
</div>

<div class="position-relative mt-5">
  <img src="/assets/images/banner-news.png" class="img-fluid banner_image" alt="Banner" />
  <div
    class="position-absolute bottom-0 start-50 translate-middle-x text-white banner_image_text banner_image_text_news">
    <h1 class="fw-bold lh-1">SynoCast<span class="fs-6">.news</span></h1>
    <p class="fw-normal fs-4">
      Your guide to weather: Accurate forecasts and climate stories.
    </p>
  </div>
  <div class="icons news-banner-icons position-absolute bottom-0 text-white banner-subtitle">
    <a class="icon-link" href="https://www.linkedin.com/in/afnanulhaqque/">
      <img src="/assets/icons/linkedin-white.png" alt="LinkedIn" class="icon">
    </a>
    <a class="icon-link" href="https://www.instagram.com/afn6n_x/">
      <img src="/assets/icons/instagram-white.png" alt="Instagram" class="icon">
    </a>
  </div>
</div>

<div class="container mt-5 latest-news-section">
  <div class="row mb-4 align-items-center">
    <div class="col-12 d-flex align-items-center">
      <h2 class="fw-bold text-uppercase mb-0 me-3 section-title">Latest Headlines</h2>
      <div class="flex-grow-1 header-line"></div>
      <a href="/news" class="btn btn-sm btn-outline-primary rounded-pill ms-3 view-all-btn d-none d-md-block">View
        All</a>
    </div>
  </div>

  <div class="row">
    {% if latest_news %}
    <div class="col-lg-6 mb-4 mb-lg-0">
      <div class="card border-0 h-100 shadow-sm hover-lift overflow-hidden rounded-4">
        <div class="position-relative">
          <img
            src="{{ latest_news[0].urlToImage if latest_news[0].urlToImage else '/assets/images/sub-banner-news.png' }}"
            class="card-img-top" alt="{{ latest_news[0].title }}" style="height: 400px; object-fit: cover;"
            loading="lazy" decoding="async">
          <div class="position-absolute top-0 start-0 m-3">
            <span
              class="badge rounded-pill bg-{{ 'danger' if latest_news[0].urgency == 'Critical' else 'warning' if latest_news[0].urgency == 'High' else 'info' if latest_news[0].urgency == 'Medium' else 'secondary' }} px-3">
              {{ latest_news[0].urgency }}
            </span>
          </div>
        </div>
        <div class="card-body p-4">
          <div class="small text-muted mb-2 d-flex justify-content-between">
            <span><i class="fas fa-map-marker-alt me-1"></i> {{ latest_news[0].location }}</span>
            <span><i class="far fa-clock me-1"></i> {{ latest_news[0].publishedAt[:10] }}</span>
          </div>
          <h4 class="fw-bold mb-3">{{ latest_news[0].title }}</h4>
          <p class="text-muted small mb-4">{{ latest_news[0].summary }}</p>
          <a href="{{ latest_news[0].url }}" target="_blank"
            class="btn btn-primary rounded-pill px-4 fw-bold small">Read Full Story</a>
        </div>
      </div>
    </div>

    <div class="col-lg-6">
      <div class="d-flex flex-column gap-3">
        {% for article in latest_news[1:4] %}
        <div class="card border-0 shadow-sm hover-lift transition-all rounded-4 overflow-hidden">
          <div class="row g-0 align-items-center">
            <div class="col-4">
              <img src="{{ article.urlToImage if article.urlToImage else '/assets/images/breaking-news-1.png' }}"
                class="img-fluid" alt="News" style="height: 120px; width: 100%; object-fit: cover;" loading="lazy">
            </div>
            <div class="col-8">
              <div class="card-body p-3">
                <div class="d-flex justify-content-between align-items-center mb-1">
                  <span class="badge bg-light text-primary border rounded-pill x-small px-2">{{ article.category
                    }}</span>
                  <span class="x-small text-muted">{{ article.publishedAt[:10] }}</span>
                </div>
                <h6 class="fw-bold mb-1" style="font-size: 0.95rem;">{{ article.title[:85] }}...</h6>
                <a href="{{ article.url }}" target="_blank"
                  class="text-primary fw-bold text-decoration-none x-small">Read More â†’</a>
              </div>
            </div>
          </div>
        </div>
        {% endfor %}
      </div>
    </div>
    {% endif %}
  </div>
</div>

<div class="container mt-5 mb-5">
  <div class="row mb-4 align-items-center">
    <div class="col-12 d-flex align-items-center">
      <h2 class="fw-bold text-uppercase mb-0 me-3 section-title">Around The World</h2>
      <div class="flex-grow-1 header-line"></div>
    </div>
  </div>
  <div class="row g-4">
    {% if world_news %}
    {% for article in world_news %}
    {{ weather_news_card(article) }}
    {% endfor %}
    {% endif %}
  </div>
</div>

<script src="/assets/js/home_weather_card.js"></script>
{% endblock body %}