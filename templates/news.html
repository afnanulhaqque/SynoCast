{% extends "base.html" %}
{% from "macros.html" import news_card, weather_news_card %}

{% block title %} News {% endblock title %}

{% block body %}

<div class="position-relative">
  <img src="/assets/images/banner-news.png" class="img-fluid banner_image" alt="Banner" />
  <div
    class="position-absolute bottom-0 start-50 translate-middle-x text-white banner_image_text banner_image_text_news">
    <h1 class="fw-bold lh-1">SynoCast<span class="fs-6">.news</span></h1>
    <p class="fw-normal fs-4">
      Your guide to weather: Accurate forecasts, storm warnings, tips for preparing and more.
    </p>
  </div>
</div>

<div class="container text-center mt-5 news_sub_banner">
  <div class="row justify-content-md-center">
    {% if breaking_news %}
    <div class="col-lg-8">
      <div class="card shadow-sm border-0 rounded-4 overflow-hidden">
        <div class="card-body p-4 p-md-5">
          <div class="d-flex justify-content-between align-items-center mb-3">
            <span class="badge rounded-pill bg-danger px-3">{{ breaking_news[0].urgency }}</span>
            <span class="text-muted small"><i class="fas fa-map-marker-alt me-1"></i> {{ breaking_news[0].location
              }}</span>
          </div>
          <h2 class="card-title fw-bold mb-3">{{ breaking_news[0].title }}</h2>
          <p class="card-text text-muted lead">{{ breaking_news[0].summary }}</p>
          <div class="d-flex justify-content-between align-items-center mt-4">
            <span class="text-muted small"><i class="far fa-clock me-1"></i> {{ breaking_news[0].publishedAt[:10]
              }}</span>
            <a href="{{ breaking_news[0].url }}" target="_blank"
              class="btn btn_get_started rounded-pill px-4 fw-bold">Read
              Full Article</a>
          </div>
        </div>
        <img
          src="{{ breaking_news[0].urlToImage if breaking_news[0].urlToImage else '/assets/images/sub-banner-news.png' }}"
          class="card-img-bottom" alt="Featured News" style="height: 450px; object-fit: cover;">
      </div>
    </div>

    <div class="col-lg-4">
      <div class="d-flex flex-column gap-3">
        {% for article in breaking_news[1:4] %}
        <div class="card shadow-sm border-0 rounded-4 overflow-hidden">
          <div class="card-body p-3">
            <div class="d-flex justify-content-between x-small mb-2">
              <span class="badge bg-light text-primary border rounded-pill px-2">{{ article.category }}</span>
              <span class="text-muted">{{ article.publishedAt[:10] }}</span>
            </div>
            <h6 class="card-title fw-bold mb-2" style="font-size: 0.95rem;">{{ article.title[:80] }}...</h6>
            <p class="card-text text-muted x-small mb-3">{{ article.summary[:100] }}...</p>
            <a href="{{ article.url }}" target="_blank" class="text-primary text-decoration-none x-small fw-bold">Read
              more</a>
          </div>
        </div>
        {% endfor %}
      </div>
    </div>
    {% else %}
    <div class="col-12 py-5 text-center">
      <div class="spinner-border text-primary" role="status"></div>
      <p class="text-muted mt-2">Loading weather news...</p>
    </div>
    {% endif %}
  </div>
</div>

<div class="container mt-5 pt-3">
  <h4 class="fw-bold mb-4">Breaking News</h4>
  <div class="row g-4">
    {% if breaking_news %}
    {% for article in breaking_news %}
    {{ weather_news_card(article) }}
    {% endfor %}
    {% endif %}
  </div>
</div>

<div class="container mt-5 pt-3 mb-5">
  <h4 class="fw-bold mb-4">Featured Stories</h4>
  <div class="row g-4">
    {% if featured_news %}
    {% for article in featured_news %}
    {{ weather_news_card(article) }}
    {% endfor %}
    {% endif %}
  </div>
</div>

{% endblock body %}