{% extends "base.html" %}
{% from "macros.html" import news_card %}

{% block title %} News {% endblock title %}

{% block body %}

<div class="position-relative">
  <img src="/assets/images/banner-news.png" class="img-fluid banner_image" alt="Banner" />
  <div
    class="position-absolute bottom-0 start-50 translate-middle-x text-white banner_image_text banner_image_text_news">
    <h1 class="fw-bold lh-1">SynoCast<span class="fs-6">.news</span></h1>
    <p class="fw-normal fs-4">
      Your guide to weather: Accurate forecasts, storm warnings, tips for preparing and more.
    </p>
  </div>
</div>

<div class="container text-center mt-5 news_sub_banner">
  <div class="row justify-content-md-center">
    {% if breaking_news %}
    <div class="col-8">
      <div class="card shadow-sm border-0">
        <div class="card-body">
          <h5 class="card-title fw-bold">{{ breaking_news[0].title }}</h5>
          <p class="card-text text-muted">{{ breaking_news[0].description[:300] }}{% if
            breaking_news[0].description|length > 300 %}...{% endif %}</p>
          <div class="d-flex justify-content-between align-items-center mt-3">
            <span class="text-muted small">{{ breaking_news[0].author if breaking_news[0].author else 'News Desk'
              }}</span>
            <a href="{{ breaking_news[0].url }}" target="_blank"
              class="text-primary text-decoration-none fw-bold small">Read Full Article</a>
          </div>
        </div>
        <img
          src="{{ breaking_news[0].urlToImage if breaking_news[0].urlToImage else '/assets/images/sub-banner-news.png' }}"
          class="card-img-bottom" alt="Featured News" style="height: 400px; object-fit: cover;">
      </div>
    </div>

    <div class="col-4">
      {% for article in breaking_news[1:4] %}
      <div class="card mb-3 shadow-sm border-0">
        <div class="card-body p-3">
          <h6 class="card-title fw-bold mb-1" style="font-size: 0.9rem;">{{ article.title[:80] }}...</h6>
          <p class="card-text text-muted x-small mb-2">{{ article.description[:80] }}...</p>
          <a href="{{ article.url }}" target="_blank" class="text-primary text-decoration-none x-small fw-bold">Read
            more</a>
        </div>
      </div>
      {% endfor %}
    </div>
    {% else %}
    <div class="col-12 py-5">
      <div class="spinner-border text-primary" role="status"></div>
      <p class="text-muted mt-2">Loading weather news...</p>
    </div>
    {% endif %}
  </div>
</div>

<div class="container mt-5 pt-3">
  <h4 class="fw-bold mb-4">Breaking News</h4>
  <div class="row g-4">
    {% if breaking_news %}
    {% for article in breaking_news[:3] %}
    {{ news_card(article, loop.index, type='breaking') }}
    {% endfor %}
    {% endif %}
  </div>
</div>

<div class="container mt-5 pt-3 mb-5">
  <h4 class="fw-bold mb-4">Featured Stories</h4>
  <div class="row g-4">
    {% if featured_news %}
    {% for article in featured_news %}
    {{ news_card(article, loop.index, type='featured') }}
    {% endfor %}
    {% endif %}
  </div>
</div>

{% endblock body %}